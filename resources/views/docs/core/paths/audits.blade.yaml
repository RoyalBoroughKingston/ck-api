# /audits
root:
  get:
    tags: [Audits]
    summary: List all the audits
    description: |
      **Permission:** `Global Admin`
    parameters:
      - $ref: /docs/core/parameters/page.yaml
      - $ref: /docs/core/parameters/per-page.yaml
      - $ref: /docs/core/parameters/filter-id.yaml
      - name: filter[user_id]
        in: query
        description: Comma seperated list of user IDs to filter by
        schema:
          type: string
      - name: filter[oauth_client_id]
        in: query
        description: Comma seperated list of OAuth client IDs to filter by
        schema:
          type: string
      - name: filter[action]
        in: query
        description: Action to filter by
        schema:
          type: string
          enum:
            - create
            - read
            - update
            - delete
      - name: filter[description]
        in: query
        description: Description to filter by
        schema:
          type: string
      - name: include
        in: query
        description: The relationships to include with the response [`user`]
        schema:
          type: string
      - name: sort
        in: query
        description: The fields to sort by [`action`, `description`, `user_full_name`, `created_at`]
        schema:
          type: string
          default: -created_at
    responses:
      200:
        content:
          application/json:
            schema:
              allOf:
                - $ref: /docs/core/responses/resource-collection.yaml
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: /docs/core/resources/audit.yaml

# /audits/index
index:
  post:
    tags: [Audits]
    summary: List all the audits
    description: |
      This is an alias of `GET /audits` which allows all the query string parameters
      to be passed as part of the request body.

# /audits/{audit}
nested:
  get:
    tags: [Audits]
    summary: Get a specific audit
    description: |
      **Permission:** `Global Admin`
    parameters:
      - name: audit
        in: path
        description: The ID of the audit
        required: true
        schema:
          type: string
          format: uuid
      - name: include
        in: query
        description: The relationships to include with the response [`user`]
        schema:
          type: string
    responses:
      200:
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  $ref: /docs/core/resources/audit.yaml
